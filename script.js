const translations = {
    en: {
        "wip-tag": "WIP",
        "page-title": "Francisco Javier - Portfolio",
        "nav-home": "Home",
        "nav-about": "About",
        "nav-skills": "Skills",
        "nav-projects": "Projects",
        "nav-experience": "Experience",
        "nav-contact": "Contact",
        "lang-en-aria": "Switch to English",
        "lang-es-aria": "Switch to Spanish",
        "tagline": "Crafting Engaging Experiences | Junior Software Developer | Unity & Web Enthusiast",
        "download-cv": "Download CV",
        "cv-url": "https://raw.githubusercontent.com/metalfurius/metalfurius.github.io/main/CV%20Francisco%20Javier%20Hern%C3%A1ndez%20Murillo%20English.pdf",
        "about-title": "About Me",
        "about-p1": "Hi, I'm Francisco Javier, a passionate software developer blending game development with web technologies. My journey began with a curiosity for creating worlds, leading me to master C# in Unity and build interactive experiences.",
        "about-p2": "Now, I’m diving into web development, mastering JavaScript, HTML, and CSS to craft intuitive web applications. My game design roots inspire me to bring creativity and interactivity to every project.",
        "about-p3": "My approach is user-centered—I strive for interfaces that are both beautiful and functional. Outside of coding, I craft custom resin dice and lose myself in D&D campaigns, fueling my creativity and sharpening my problem-solving skills.",
        "skills-title": "Skills",
        "skill-web-title": "Web Development",
        "skill-web-js": "<strong>JavaScript:</strong> Used to build interactive features in my Task Management Application.",
        "skill-web-html": "<strong>HTML5:</strong> Proficient in creating semantic and accessible web structures.",
        "skill-web-css": "<strong>CSS3:</strong> Skilled in styling and layout techniques, including Flexbox and Grid.",
        "skill-languages-title": "Programming Languages",
        "skill-languages-cs": "<strong>C#:</strong> Leveraged C# to develop VR interactions in Unity.",
        "skill-languages-python": "<strong>Python:</strong> Experienced in scripting and automation.",
        "skill-languages-java": "<strong>Java:</strong> Familiar with object-oriented programming concepts.",
        "skill-tools-title": "Tools & Platforms",
        "skill-tools-git": "<strong>Git:</strong> Proficient in version control using Git and GitHub.",
        "skill-tools-firebase": "<strong>Firebase:</strong> Integrated Firebase for secure data persistence in a mobile game.",
        "skill-tools-unity": "<strong>Unity:</strong> Extensive experience in game and VR development using Unity.",
        "projects-title": "Personal Projects",
        "project-1-title": "Personal Portfolio Website",
        "project-1-desc": "Responsive design showcasing my projects...",
        "learn-more": "Learn More",
        "project-1-modal-title": "Personal Portfolio Website",
        "project-1-modal-desc": "This website itself is a project!  Built with HTML, CSS, and JavaScript, it showcases my ability to create responsive, modern web designs. Key features include:",
        "project-1-feature-1": "Smooth scrolling navigation",
        "project-1-feature-2": "Interactive project cards with modals",
        "project-1-feature-3": "Scroll-triggered animations",
        "project-1-feature-4": "Responsive design for mobile and desktop",
        "project-1-tech": "<strong>Technologies:</strong> HTML, CSS, JavaScript",
        "project-1-visit": "Visit Website",
        "view-github": "View on GitHub",
        "project-2-title": "Task Management Application",
        "project-2-desc": "Interactive web app with local storage...",
        "project-2-modal-title": "Task Management Application",
        "project-2-modal-desc": "A web application built with JavaScript to manage tasks efficiently.  It utilizes local storage to persist data and offers a clean, intuitive user interface. I later integrated Firebase for enhanced data management.",
        "project-2-feature-1": "Add, edit, and delete tasks",
        "project-2-feature-2": "Mark tasks as complete",
        "project-2-feature-3": "Local storage persistence",
        "project-2-feature-5": "Responsive design",
        "project-2-tech": "<strong>Technologies:</strong> JavaScript, HTML, CSS, Local Storage",
        "project-2-demo": "View Demo",
        "project-3-title": "Credit Cleaners",
        "project-3-desc": "Arcade-style game developed during Sevilla Jam...",
        "project-3-modal-title": "Credit Cleaners",
        "project-3-modal-desc": "\"Credit Cleaners\" is an arcade-style game where players must clean a cinema filled with obstacles while the movie credits roll. Developed during the Sevilla Jam, each level introduces new challenges that test the player's speed and strategy. I collaborated in programming the gameflow, player animations, the camera system, and all aspects of player control. We also won first place with this submission!",
        "project-3-feature-1": "Arcade-style gameplay",
        "project-3-feature-2": "Obstacle navigation and cleaning mechanics",
        "project-3-feature-3": "Dynamic level progression",
        "project-3-feature-4": "First place winner at Sevilla Jam",
        "project-3-tech": "<strong>Technologies:</strong> Unity, C#",
        "project-3-play": "Play Game",
        "project-4-title": "2048",
        "project-4-desc": "Classic puzzle game recreated with TDD...",
        "project-4-modal-title": "2048",
        "project-4-modal-desc": "Recreated the classic 2048 sliding block puzzle game from scratch using Test-Driven Development (TDD) methodology. Developed game logic, including tile movements, merging, and new tile generation, with a focus on writing comprehensive tests. Implemented a dynamic game board view with updates for tile colors and numbers. Managed scoring system with real-time updates.",
        "project-4-feature-1": "Classic 2048 gameplay mechanics",
        "project-4-feature-2": "Test-Driven Development (TDD) approach",
        "project-4-feature-3": "Dynamic game board with visual updates",
        "project-4-feature-4": "Real-time scoring system",
        "project-4-tech": "<strong>Technologies:</strong> Unity, C#",
        "project-5-title": "Luckbound",
        "project-5-desc": "Team-based dungeon crawler RPG with random generation...",
        "project-5-modal-title": "Luckbound",
        "project-5-modal-desc": "Currently developing \"Luckbound,\" a dungeon crawler RPG, as part of a collaborative team project. The goal is to create an engaging experience featuring randomly generated dungeons, distinct character classes, crafting systems, and skill-based challenges. This project is actively in development.",
        "project-5-modal-features-title": "<strong>Key Features (In Development):</strong>",
        "project-5-feature-1": "Randomized dungeon layouts",
        "project-5-feature-2": "Multiple character classes (Warrior, Archer, Mage)",
        "project-5-feature-3": "Crafting and meta-progression systems",
        "project-5-feature-4": "Skill check mechanics impacting gameplay",
        "project-5-feature-5": "Narrative elements and NPC interactions",
        "project-5-feature-6": "Team-based development effort",
        "project-5-tech": "<strong>Technologies:</strong> Unity, C#",
        "experience-title": "Experience",
        "experience-vr-title": "VR Unity Developer",
        "experience-vr-company": "Visionary Tool (Nov 2023 - May 2024)",
        "experience-vr-li1": "Developed interactive UI systems and real-time network features.",
        "experience-vr-li2": "Created user-friendly interfaces for VR and desktop platforms.",
        "experience-vr-li3": "Improved cross-platform compatibility with responsive design.",
        "experience-intern-title": "Unity Developer Intern",
        "experience-intern-company": "FunTech Rocket (Apr 2023 - Jun 2023)",
        "experience-intern-li1": "Implemented event-driven programming patterns.",
        "experience-intern-li2": "Integrated Firebase for authentication and data persistence.",
        "experience-intern-li3": "Enhanced code quality through refactoring.",
        "contact-title": "Contact",
        "copyright": "© 2025 Francisco Javier Hernández",
        "roll-dice": "Roll the Dice",
        "dice-roll-text": "You rolled a <strong>{roll}</strong> on a D20! {message}"
    },
    es: {
        "wip-tag": "En Progreso",
        "page-title": "Francisco Javier - Portafolio",
        "nav-home": "Inicio",
        "nav-about": "Sobre mí",
        "nav-skills": "Habilidades",
        "nav-projects": "Proyectos",
        "nav-experience": "Experiencia",
        "nav-contact": "Contacto",
        "lang-en-aria": "Cambiar a Inglés",
        "lang-es-aria": "Cambiar a Español",
        "tagline": "Creando Experiencias Atractivas | Desarrollador de Software Junior | Entusiasta de Unity y Web",
        "download-cv": "Descargar CV",
        "cv-url": "https://raw.githubusercontent.com/metalfurius/metalfurius.github.io/main/CV%20Francisco%20Javier%20Hern%C3%A1ndez%20Murillo%20Spanish.pdf",
        "about-title": "Sobre Mí",
        "about-p1": "Hola, soy Francisco Javier, un apasionado desarrollador de software que combina el desarrollo de juegos con tecnologías web. Mi viaje comenzó con una curiosidad por crear mundos, lo que me llevó a dominar C# en Unity y construir experiencias interactivas.",
        "about-p2": "Ahora, me estoy sumergiendo en el desarrollo web, dominando JavaScript, HTML y CSS para crear aplicaciones web intuitivas. Mis raíces en el diseño de juegos me inspiran a aportar creatividad e interactividad a cada proyecto.",
        "about-p3": "Mi enfoque está centrado en el usuario: me esfuerzo por crear interfaces que sean tanto hermosas como funcionales. Fuera de la programación, fabrico dados de resina personalizados y me pierdo en campañas de D&D, alimentando mi creatividad y afinando mis habilidades para resolver problemas.",
        "skills-title": "Habilidades",
        "skill-web-title": "Desarrollo Web",
        "skill-web-js": "<strong>JavaScript:</strong> Utilizado para construir características interactivas en mi Aplicación de Gestión de Tareas.",
        "skill-web-html": "<strong>HTML5:</strong> Experto en crear estructuras web semánticas y accesibles.",
        "skill-web-css": "<strong>CSS3:</strong> Hábil en técnicas de estilo y diseño, incluyendo Flexbox y Grid.",
        "skill-languages-title": "Lenguajes de Programación",
        "skill-languages-cs": "<strong>C#:</strong> Utilizado para desarrollar interacciones VR en Unity.",
        "skill-languages-python": "<strong>Python:</strong> Experimentado en scripting y automatización.",
        "skill-languages-java": "<strong>Java:</strong> Familiarizado con conceptos de programación orientada a objetos.",
        "skill-tools-title": "Herramientas y Plataformas",
        "skill-tools-git": "<strong>Git:</strong> Experto en control de versiones usando Git y GitHub.",
        "skill-tools-firebase": "<strong>Firebase:</strong> Integrado Firebase para persistencia de datos segura en un juego móvil.",
        "skill-tools-unity": "<strong>Unity:</strong> Amplia experiencia en desarrollo de juegos y VR usando Unity.",
        "projects-title": "Proyectos Personales",
        "project-1-title": "Sitio Web de Portafolio Personal",
        "project-1-desc": "Diseño responsivo mostrando mis proyectos...",
        "learn-more": "Aprender Más",
        "project-1-modal-title": "Sitio Web de Portafolio Personal",
        "project-1-modal-desc": "¡Este sitio web en sí es un proyecto! Construido con HTML, CSS y JavaScript, muestra mi capacidad para crear diseños web responsivos y modernos. Las características clave incluyen:",
        "project-1-feature-1": "Navegación con desplazamiento suave",
        "project-1-feature-2": "Tarjetas de proyecto interactivas con modales",
        "project-1-feature-3": "Animaciones activadas por desplazamiento",
        "project-1-feature-4": "Diseño responsivo para móvil y escritorio",
        "project-1-tech": "<strong>Tecnologías:</strong> HTML, CSS, JavaScript",
        "project-1-visit": "Visitar Sitio Web",
        "view-github": "Ver en GitHub",
        "project-2-title": "Aplicación de Gestión de Tareas",
        "project-2-desc": "Aplicación web interactiva con almacenamiento local...",
        "project-2-modal-title": "Aplicación de Gestión de Tareas",
        "project-2-modal-desc": "Una aplicación web construida con JavaScript para gestionar tareas eficientemente. Utiliza almacenamiento local para persistir datos y ofrece una interfaz de usuario limpia e intuitiva. Más tarde integré Firebase para una gestión de datos mejorada.",
        "project-2-feature-1": "Agregar, editar y eliminar tareas",
        "project-2-feature-2": "Marcar tareas como completadas",
        "project-2-feature-3": "Persistencia de almacenamiento local",
        "project-2-feature-5": "Diseño responsivo",
        "project-2-tech": "<strong>Tecnologías:</strong> JavaScript, HTML, CSS, Almacenamiento Local",
        "project-2-demo": "Ver Demo",
        "project-3-title": "Credit Cleaners",
        "project-3-desc": "Juego arcade desarrollado durante Sevilla Jam...",
        "project-3-modal-title": "Credit Cleaners",
        "project-3-modal-desc": "\"Credit Cleaners\" es un juego arcade donde los jugadores deben limpiar un cine lleno de obstáculos mientras ruedan los créditos de la película. Desarrollado durante la Sevilla Jam, cada nivel introduce nuevos desafíos que ponen a prueba la velocidad y estrategia del jugador. Colaboré en la programación del flujo del juego, animaciones del jugador, el sistema de cámara y todos los aspectos del control del jugador. ¡También ganamos el primer lugar con este proyecto!",
        "project-3-feature-1": "Jugabilidad estilo arcade",
        "project-3-feature-2": "Navegación de obstáculos y mecánicas de limpieza",
        "project-3-feature-3": "Progresión dinámica de niveles",
        "project-3-feature-4": "Ganador del primer lugar en Sevilla Jam",
        "project-3-tech": "<strong>Tecnologías:</strong> Unity, C#",
        "project-3-play": "Jugar",
        "project-4-title": "2048",
        "project-4-desc": "Juego de puzzle clásico recreado con TDD...",
        "project-4-modal-title": "2048",
        "project-4-modal-desc": "Recreé el clásico juego de puzzle 2048 desde cero utilizando la metodología de Desarrollo Guiado por Pruebas (TDD). Desarrollé la lógica del juego, incluyendo movimientos de fichas, fusión y generación de nuevas fichas, con un enfoque en escribir pruebas exhaustivas. Implementé una vista dinámica del tablero con actualizaciones para los colores y números de las fichas. Gestioné el sistema de puntuación con actualizaciones en tiempo real.",
        "project-4-feature-1": "Mecánicas clásicas de 2048",
        "project-4-feature-2": "Enfoque de Desarrollo Guiado por Pruebas (TDD)",
        "project-4-feature-3": "Tablero dinámico con actualizaciones visuales",
        "project-4-feature-4": "Sistema de puntuación en tiempo real",
        "project-4-tech": "<strong>Tecnologías:</strong> Unity, C#",
        "project-5-title": "Luckbound",
        "project-5-desc": "RPG dungeon crawler en equipo con generación aleatoria...",
        "project-5-modal-title": "Luckbound",
        "project-5-modal-desc": "Actualmente desarrollando \"Luckbound\", un RPG de exploración de mazmorras, como parte de un proyecto colaborativo en equipo. El objetivo es crear una experiencia atractiva con mazmorras generadas aleatoriamente, clases de personajes distintas, sistemas de crafteo y desafíos basados en habilidades. Este proyecto está activamente en desarrollo.",
        "project-5-modal-features-title": "<strong>Características Clave (En Desarrollo):</strong>",
        "project-5-feature-1": "Diseños de mazmorras aleatorios",
        "project-5-feature-2": "Múltiples clases de personajes (Guerrero, Arquero, Mago)",
        "project-5-feature-3": "Sistemas de crafteo y meta-progresión",
        "project-5-feature-4": "Mecánicas de chequeo de habilidades que impactan el juego",
        "project-5-feature-5": "Elementos narrativos e interacciones con NPCs",
        "project-5-feature-6": "Esfuerzo de desarrollo en equipo",
        "project-5-tech": "<strong>Tecnologías:</strong> Unity, C#",
        "experience-title": "Experiencia",
        "experience-vr-title": "Desarrollador VR Unity",
        "experience-vr-company": "Visionary Tool (Nov 2023 - May 2024)",
        "experience-vr-li1": "Desarrollé sistemas de UI interactivos y características de red en tiempo real.",
        "experience-vr-li2": "Creé interfaces amigables para plataformas VR y de escritorio.",
        "experience-vr-li3": "Mejoré la compatibilidad entre plataformas con diseño responsivo.",
        "experience-intern-title": "Desarrollador Unity en prácticas",
        "experience-intern-company": "FunTech Rocket (Apr 2023 - Jun 2023)",
        "experience-intern-li1": "Implementé patrones de programación impulsados por eventos.",
        "experience-intern-li2": "Integré Firebase para autenticación y persistencia de datos.",
        "experience-intern-li3": "Mejoré la calidad del código mediante refactorización.",
        "contact-title": "Contacto",
        "copyright": "© 2025 Francisco Javier Hernández",
        "roll-dice": "Tirar el Dado",
        "dice-roll-text": "¡Sacaste un <strong>{roll}</strong> en un D20! {message}"
    }
};

const rollMessages = {
    en: {
        low: "Ouch, a bit low! Maybe hiring me will boost your luck?",
        medium: "Not bad, but there’s room for improvement. Let’s work together!",
        high: "Pretty good! Imagine what we could achieve as a team.",
        veryHigh: "Impressive roll! Clearly, you’re on a lucky streak.",
        critical: "Critical success! You must be destined to hire me!"
    },
    es: {
        low: "¡Uy, un poco bajo! ¿Quizás contratarme mejorará tu suerte?",
        medium: "No está mal, pero hay espacio para mejorar. ¡Trabajemos juntos!",
        high: "¡Bastante bien! Imagina lo que podríamos lograr como equipo.",
        veryHigh: "¡Impresionante tirada! Claramente, estás en una racha de suerte.",
        critical: "¡Éxito crítico! ¡Debes estar destinado a contratarme!"
    }
};

let currentLanguage = localStorage.getItem('language') || 'en';

function setLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang] && translations[lang][key]) {
            element.innerHTML = translations[lang][key];
        }
    });
    document.querySelectorAll('[data-aria-label]').forEach(element => {
        const key = element.getAttribute('data-aria-label');
        if (translations[lang] && translations[lang][key]) {
            element.setAttribute('aria-label', translations[lang][key]);
        }
    });
    document.documentElement.lang = lang;
    document.title = translations[lang]["page-title"];
    document.querySelectorAll('.lang-button').forEach(button => {
        button.classList.remove('active');
        if (button.getAttribute('data-lang') === lang) {
            button.classList.add('active');
        }
    });
    const cvButton = document.getElementById('download-cv');
    if (cvButton) {
        cvButton.href = translations[lang]["cv-url"];
    }

    const taglineText = translations[lang]['tagline'];
    typeWriter(taglineText);
}

function getRollMessage(roll) {
    if (roll <= 5) return rollMessages[currentLanguage].low;
    else if (roll <= 10) return rollMessages[currentLanguage].medium;
    else if (roll <= 15) return rollMessages[currentLanguage].high;
    else if (roll <= 19) return rollMessages[currentLanguage].veryHigh;
    else return rollMessages[currentLanguage].critical;
}

let typeInterval; // Variable global para almacenar el ID del intervalo

function typeWriter(text) {
    let charIndex = 0;
    const taglineElement = document.querySelector('.tagline');
    taglineElement.innerHTML = ''; // Limpiar el contenido actual
    if (typeInterval) {
        clearInterval(typeInterval); // Detener cualquier animación en curso
    }
    typeInterval = setInterval(() => {
        if (charIndex < text.length) {
            taglineElement.innerHTML = text.substring(0, charIndex + 1) + '<span class="cursor"></span>';
            charIndex++;
        } else {
            clearInterval(typeInterval); // Detener el intervalo cuando termine
            typeInterval = null;
            taglineElement.innerHTML = text + '<span class="cursor"></span>'; // Cursor final que parpadea
        }
    }, 50); // Velocidad de la animación (ajustable)
}

document.addEventListener("DOMContentLoaded", function() {
    setLanguage(currentLanguage);

    document.querySelectorAll('.lang-button').forEach(button => {
        button.addEventListener('click', () => {
            const lang = button.getAttribute('data-lang');
            setLanguage(lang);
        });
    });

    const preloader = document.querySelector('.preloader-wrapper');
    setTimeout(() => {
        preloader.style.transition = 'opacity 0.5s';
        preloader.style.opacity = '0';
        setTimeout(() => {
            preloader.style.display = 'none';
            const taglineText = translations[currentLanguage]['tagline'];
            typeWriter(taglineText); // Iniciar typewriter después de ocultar el preloader
        }, 0);
    }, 1500);

    const navLinks = document.querySelectorAll('.sticky-nav a');
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                const offsetTop = targetElement.offsetTop;
                window.scrollTo({
                    top: offsetTop - 60,
                    behavior: 'smooth'
                });
                navLinks.forEach(navLink => navLink.classList.remove('active'));
                this.classList.add('active');
            }
        });
    });

    const sections = document.querySelectorAll('.section');
    const timeline = document.querySelector('.timeline');

    function checkVisibility() {
        sections.forEach(section => {
            const rect = section.getBoundingClientRect();
            if (rect.top < window.innerHeight * 0.8) {
                section.classList.add('show');
            }
        });
        const timelinerect = timeline.getBoundingClientRect();
        if (timelinerect.top < window.innerHeight * 0.8) {
            timeline.classList.add('show-timeline');
        }
    }
    checkVisibility();
    window.addEventListener('scroll', checkVisibility);

    const aboutDice = document.querySelector('.about-logo i');
    const aboutDiceResultDiv = document.getElementById('about-dice-result'); // Get the new result div

    if (aboutDice && aboutDiceResultDiv) { // Check if both elements exist
        let hideTimeout; // Variable to store the timeout ID

        aboutDice.addEventListener('click', function() {
            // Clear any existing timeout to prevent premature hiding
            if (hideTimeout) {
                clearTimeout(hideTimeout);
            }

            // --- Dice Roll Logic ---
            const roll = Math.floor(Math.random() * 20) + 1;
            const message = getRollMessage(roll);
            // --- End Dice Roll Logic ---

            // Display result in the new div
            aboutDiceResultDiv.innerHTML = translations[currentLanguage]["dice-roll-text"]
                .replace("{roll}", roll)
                .replace("{message}", message);
            aboutDiceResultDiv.classList.add('show'); // Use class for visibility

            // Set timeout to hide the result after 5 seconds
            hideTimeout = setTimeout(() => {
                aboutDiceResultDiv.classList.remove('show');
                hideTimeout = null; // Reset timeout ID
            }, 5000);
        });
    }

    function highlightNavLink() {
        const navLinks = document.querySelectorAll('.sticky-nav a');
        let currentSection = '';
        if ((window.innerHeight + window.scrollY) >= (document.documentElement.scrollHeight - 50)) {
            currentSection = 'contact';
        } else if (window.scrollY < 100) {
            currentSection = 'home';
        } else {
            const sections = document.querySelectorAll('.section, .hero');
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.scrollY >= (sectionTop - sectionHeight / 3)) {
                    currentSection = section.getAttribute('id');
                }
            });
        }
        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${currentSection}`) {
                link.classList.add('active');
            }
        });
    }

    const nav = document.querySelector('.sticky-nav');
    window.addEventListener('scroll', function() {
        nav.classList.toggle('shrunk', window.scrollY > 50);
    });

    window.addEventListener('scroll', highlightNavLink);
    document.addEventListener('DOMContentLoaded', highlightNavLink);

    const projectCards = document.querySelectorAll('.project-card');
    const projectModals = document.querySelectorAll('.project-modal');
    const closeButtons = document.querySelectorAll('.close-modal');

    projectCards.forEach(card => {
        card.addEventListener('click', function(event) {
            if (event.target.closest('.project-button')) {
                const projectId = this.dataset.project;
                const modal = document.getElementById(projectId);
                if (modal) {
                    modal.style.display = 'block';
                    document.body.classList.add('modal-open'); // Add class to body
                }
            }
        });
    });

    closeButtons.forEach(button => {
        button.addEventListener('click', function() {
            this.closest('.project-modal').style.display = 'none';
            document.body.classList.remove('modal-open');
        });
    });

    window.addEventListener('click', function(event) {
        projectModals.forEach(modal => {
            if (event.target === modal) {
                modal.style.display = 'none';
                document.body.classList.remove('modal-open');
            }
        });
    });

    setTimeout(() => {
        particlesJS('particles-js', {
            "particles": {
                "number": { "value": 80, "density": { "enable": true, "value_area": 800 } },
                "color": { "value": "#ffffff" },
                "shape": { "type": "circle", "stroke": { "width": 0, "color": "#000000" } },
                "opacity": { "value": 0.5, "random": false },
                "size": { "value": 3, "random": true },
                "line_linked": { "enable": true, "distance": 150, "color": "#ffffff", "opacity": 0.4, "width": 1 },
                "move": { "enable": true, "speed": 2, "direction": "none", "random": false, "straight": false, "out_mode": "out", "bounce": false }
            },
            "interactivity": {
                "detect_on": "canvas",
                "events": { "onHover": { "enable": true, "mode": "repulse" }, "onclick": { "enable": true, "mode": "push" }, "resize": true },
                "modes": { "repulse": { "distance": 100, "duration": 0.4 }, "push": { "particles_nb": 4 } }
            },
            "retina_detect": true
        });
    }, 1500);

    const scrollArrow = document.querySelector('.scroll-down-arrow');

    if (scrollArrow) {
        const hideArrowOnScroll = () => {
            scrollArrow.classList.add('hidden');
        };

        window.addEventListener('scroll', hideArrowOnScroll, { once: true });

        scrollArrow.addEventListener('click', () => {
            setTimeout(() => {
                if (!scrollArrow.classList.contains('hidden')) {
                    scrollArrow.classList.add('hidden');
                    // Explicitly remove the scroll listener if arrow is clicked before scrolling
                    window.removeEventListener('scroll', hideArrowOnScroll);
                }
            }, 100); // 100ms delay
        });
    }
});